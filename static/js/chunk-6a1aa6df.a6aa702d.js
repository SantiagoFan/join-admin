(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6a1aa6df"],{"09f4":function(t,e,a){"use strict";a.d(e,"a",function(){return l}),Math.easeInOutQuad=function(t,e,a,i){return t/=i/2,t<1?a/2*t*t+e:(t--,-a/2*(t*(t-2)-1)+e)};var i=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(t){window.setTimeout(t,1e3/60)}}();function n(t){document.documentElement.scrollTop=t,document.body.parentNode.scrollTop=t,document.body.scrollTop=t}function s(){return document.documentElement.scrollTop||document.body.parentNode.scrollTop||document.body.scrollTop}function l(t,e,a){var l=s(),o=t-l,r=20,c=0;e="undefined"===typeof e?500:e;var u=function t(){c+=r;var s=Math.easeInOutQuad(c,l,o,e);n(s),c<e?i(t):a&&"function"===typeof a&&a()};u()}},"49d3":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"app-container"},[a("el-tabs",{attrs:{type:"card"},on:{"tab-click":t.SearchData},model:{value:t.listQuery.state,callback:function(e){t.$set(t.listQuery,"state",e)},expression:"listQuery.state"}},[a("el-tab-pane",{attrs:{label:"已发起",name:"0"}}),t._v(" "),a("el-tab-pane",{attrs:{label:"已同意",name:"1"}}),t._v(" "),a("el-tab-pane",{attrs:{label:"已拒绝",name:"2"}})],1),t._v(" "),a("div",{staticClass:"filter-container",staticStyle:{display:"inline-block",float:"right"}},[a("el-input",{staticClass:"filter-item",staticStyle:{width:"200px"},attrs:{placeholder:"产品名称或者订单号"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.SearchData(e)}},model:{value:t.listQuery.search,callback:function(e){t.$set(t.listQuery,"search",e)},expression:"listQuery.search"}}),t._v(" "),a("el-select",{staticClass:"filter-item",attrs:{placeholder:"请选择售后服务类别","change-on-select":!1,value:"",clearable:""},on:{clear:t.typeClear},model:{value:t.listQuery.type,callback:function(e){t.$set(t.listQuery,"type",e)},expression:"listQuery.type"}},t._l(t.typeOptions,function(t){return a("el-option",{key:t.value,attrs:{value:t.value,label:t.label}})}),1),t._v(" "),a("el-button",{staticClass:"filter-item",attrs:{type:"primary",icon:"el-icon-search"},on:{click:t.SearchData}},[t._v("\n      搜索\n    ")])],1),t._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.listLoading,expression:"listLoading"}],ref:"singleTable",staticStyle:{width:"100%"},attrs:{data:t.list,fit:"","highlight-current-row":""},on:{"sort-change":t.sortChange}},[a("el-table-column",{attrs:{type:"expand"},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.row;return[a("ul",{staticClass:"info el-row"},[a("li",{staticClass:"el-col el-col-12"},[a("label",{staticClass:"info-label"},[t._v("售后状态:")]),t._v(" "),a("div",{staticClass:"info-content"},[t._v(t._s(0===i.state?"已发起":1===i.state?"已同意":"已拒绝"))])]),t._v(" "),a("li",{staticClass:"el-col el-col-12"},[a("label",{staticClass:"info-label"},[t._v("售后类别:")]),t._v(" "),a("div",{staticClass:"info-content"},[t._v(t._s(0===i.type?"换货维修":1===i.type?"退款（无需退货）":"退款退货"))])]),t._v(" "),a("li",{staticClass:"el-col el-col-12"},[a("label",{staticClass:"info-label"},[t._v("售后原因:")]),a("div",{staticClass:"info-content"},[t._v(t._s(i.reason))])]),t._v(" "),a("li",{staticClass:"el-col el-col-12"},[a("label",{staticClass:"info-label"},[t._v("售后说明:")]),a("div",{staticClass:"info-content"},[t._v(t._s(i.description))])]),t._v(" "),a("li",{staticClass:"el-col el-col-12"},[a("label",{staticClass:"info-label"},[t._v("退款金额:")]),a("div",{staticClass:"info-content"},[t._v(t._s(i.refundAmount))])]),t._v(" "),a("li",[a("label",{staticClass:"info-label"},[t._v("创建时间:")]),a("div",{staticClass:"info-content"},[t._v(t._s(t._f("parseTime")(i.createTime,"{y}-{m}-{d} {h}:{i}")))])]),t._v(" "),a("li",[a("label",{staticClass:"info-label"},[t._v("附件:")]),t._v(" "),a("div",{staticClass:"info-content attachment-container"},t._l(i.attachment.split(","),function(t,e){return a("el-image",{key:e,staticStyle:{width:"150px",height:"150px"},attrs:{src:t+"!size=s"}})}),1)]),t._v(" "),2===i.state?a("li",[a("label",{staticClass:"info-label"},[t._v("拒绝原因:")]),a("div",{staticClass:"info-content"},[t._v(t._s(i.refusedReason))])]):t._e()])]}}])}),t._v(" "),a("el-table-column",{attrs:{width:"180px",align:"center",label:"订单号",prop:"sn"}}),t._v(" "),a("el-table-column",{attrs:{width:"100px",align:"center",label:"售后状态",prop:"state",sortable:"custom"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(t.mapState(e.row.state)))])]}}])}),t._v(" "),a("el-table-column",{attrs:{width:"150px",align:"center",label:"售后服务类别",prop:"type",sortable:"custom"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(t.mapType(e.row.type)))])]}}])}),t._v(" "),a("el-table-column",{attrs:{align:"center",label:"创建时间",prop:"createTime",sortable:"custom"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(t._f("parseTime")(e.row.createTime,"{y}-{m}-{d} {h}:{i}")))])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"reason",label:"售后原因"}}),t._v(" "),a("el-table-column",{attrs:{label:"操作",align:"center",width:"230",prop:"","class-name":"small-padding fixed-width"},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.row;return[a("router-link",{attrs:{to:"/afterSale/detail?id="+i.id}},[a("el-button",{attrs:{type:"primary",plain:"",size:"mini",icon:"el-icon-more"}},[t._v("详情")])],1),t._v(" "),0===i.state?a("el-button",{attrs:{type:"success",plain:"",size:"mini",icon:"el-icon-check"},on:{click:function(e){return t.agreeApplication(i)}}},[t._v("同意\n        ")]):t._e(),t._v(" "),0===i.state?a("el-button",{attrs:{size:"mini",type:"danger",plain:"",icon:"el-icon-close"},on:{click:function(e){return t.refuseApplication(i)}}},[t._v("拒绝\n        ")]):t._e()]}}])})],1),t._v(" "),a("pagination",{directives:[{name:"show",rawName:"v-show",value:t.total>0,expression:"total>0"}],attrs:{total:t.total,page:t.listQuery.page,limit:t.listQuery.limit},on:{"update:page":function(e){return t.$set(t.listQuery,"page",e)},"update:limit":function(e){return t.$set(t.listQuery,"limit",e)},pagination:t.loadData}}),t._v(" "),a("el-dialog",{attrs:{title:"退款确认",visible:t.dialogVisible,width:"30%"},on:{"update:visible":function(e){t.dialogVisible=e}}},[a("el-form",{attrs:{model:t.form,"label-position":"left","label-width":"100px"}},[a("el-form-item",{attrs:{label:"退款金额"}},[a("el-input",{model:{value:t.form.refundAmount,callback:function(e){t.$set(t.form,"refundAmount",e)},expression:"form.refundAmount"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"退款备注"}},[a("el-input",{attrs:{type:"textarea"},model:{value:t.form.refundRemark,callback:function(e){t.$set(t.form,"refundRemark",e)},expression:"form.refundRemark"}})],1)],1),t._v(" "),a("div",{staticStyle:{"text-align":"right"}},[a("el-button",{attrs:{type:"danger"},on:{click:function(e){t.dialogVisible=!1}}},[t._v(t._s("取消"))]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.confirmRefund(t.form)}}},[t._v(t._s("确定"))])],1)],1)],1)},n=[],s=(a("ac6a"),a("b775")),l="/backEnd/afterSale",o={Query:function(t){return Object(s["a"])({url:"/backEnd/afterSaleQuery",method:"post",data:t})},Delete:function(t){return Object(s["a"])({url:l,method:"delete",data:{ids:t}})},Update:function(t){return Object(s["a"])({url:l,method:"put",data:t})},get:function(t){return Object(s["a"])({url:l,method:"get",params:{id:t}})},getExpressInfo:function(t,e){return Object(s["a"])({url:"/expressTrace",method:"get",params:{expNo:t,expCode:e,timestamp:(new Date).getTime()}})},getAfterOrderDeatial:function(t,e){return Object(s["a"])({url:"/backEnd/getAfterOrderDeatial",method:"get",params:{id:t,detailId:e,timestamp:(new Date).getTime()}})},refuseApplication:function(t){return Object(s["a"])({url:"/backEnd/refuseApplication",method:"put",data:t})}},r=o,c=a("333d"),u=a("cebb"),d={name:"GoodsList",components:{Pagination:c["a"]},filters:{},mixins:[u["a"]],data:function(){return{api:r,listQuery:{state:"0",type:void 0,search:void 0},rules:{},typeOptions:[{label:"换货维修",value:0},{label:"退款（无需退货）",value:1},{label:"退款退货",value:2}],props:{label:"name",value:"id"},stateFilters:[{text:"已发起",value:0},{text:"已同意",value:1},{text:"已拒绝",value:2}],dialogVisible:!1,form:{refundAmount:""}}},created:function(){this.loadData()},methods:{mapState:function(t){var e="";return this.stateFilters.forEach(function(a){a.value===t&&(e=a.text)}),e},mapType:function(t){var e="";return this.typeOptions.forEach(function(a){a.value===t&&(e=a.label)}),e},typeClear:function(){this.listQuery.type=void 0},refuseApplication:function(t){var e=this,a=t.id;this.$prompt("请输入拒绝原因","提示",{confirmButtonText:"确定",cancelButtonText:"取消",inputPattern:/[\w\W]+/,inputErrorMessage:"拒绝原因必填"}).then(function(t){var i=t.value,n={id:a,refusedReason:i};r.refuseApplication(n).then(function(){e.$message({message:"售后状态更新成功！",type:"success"}),e.loadData()})})},agreeApplication:function(t){var e=this,a=t.id,i=t.type;this.form.refundAmount=t.refundAmount,this.form.id=a,2===i?this.$confirm("请确认收到退回的货品后再退款！","提示",{type:"warning"}).then(function(){e.dialogVisible=!0}):1===i&&(this.dialogVisible=!0)},confirmRefund:function(t){}}},p=d,f=a("2877"),m=Object(f["a"])(p,i,n,!1,null,null,null);e["default"]=m.exports},cebb:function(t,e,a){"use strict";a("ac4d"),a("8a81"),a("ac6a");var i={filters:{statusFilter:function(t){var e={published:"success",draft:"info",deleted:"danger"};return e[t]}}};e["a"]={mixins:[i],data:function(){return{list:[],total:0,Field:"id",listQuery:{page:1,limit:10,order:"id",sort:"DESC"},listLoading:!0,downloadLoading:!1,ExportFields:["id"],dialogFormVisible:!1,dialogStatus:""}},methods:{HandleCreate:function(t){var e=this;if(this.$refs.singleTable.selection.length>0){var a={};a["ids"]=this.$refs.singleTable.selection.map(function(t){return t[e.Field]}),a["type"]=t,this.api.goodsSaleable(a).then(function(t){2e4===t.code?(e.$message({message:"操作成功",type:"success"}),e.SearchData()):e.$message({message:"操作失败",type:"error"})})}else this.$message({message:"请选择要操作的数据",type:"error"})},CreateData:function(){var t=this;this.$refs["dataForm"].validate(function(e){e&&t.api.Create(t.temp).then(function(e){t.dialogFormVisible=!1,t.SearchData(),t.$notify({title:"成功",message:"创建成功",type:"success",duration:2e3})})})},BatchDelete:function(){var t=this;if(this.$refs.singleTable.selection.length>0){var e=this.$refs.singleTable.selection.map(function(e){return e[t.Field]});this.api.Delete(e).then(function(e){2e4===e.code?(t.$message({message:"操作成功",type:"success"}),t.SearchData()):t.$message({message:"操作失败",type:"error"})})}else this.$message({message:"请选择删除的数据",type:"error"})},RowDelete:function(t){var e=this,a=[t[this.Field]];this.api.Delete(a).then(function(t){2e4===t.code?(e.$message({message:"操作成功",type:"success"}),e.SearchData()):e.$message({message:"操作失败",type:"error"})})},HandleUpdate:function(t){this.temp=Object.assign({},t),this.dialogStatus="update",this.dialogFormVisible=!0},UpdateData:function(){var t=this;this.$refs["dataForm"].validate(function(e){if(e){var a=Object.assign({},t.temp);t.api.Update(a).then(function(e){var a=!0,i=!1,n=void 0;try{for(var s,l=t.list[Symbol.iterator]();!(a=(s=l.next()).done);a=!0){var o=s.value;if(o.id===t.temp.id){var r=t.list.indexOf(o);t.list.splice(r,1,t.temp);break}}}catch(c){i=!0,n=c}finally{try{a||null==l.return||l.return()}finally{if(i)throw n}}t.dialogFormVisible=!1,t.$notify({title:"成功",message:"更新成功",type:"success",duration:2e3})})}})},ConfirmData:function(){"create"===this.dialogStatus?this.CreateData():this.UpdateData()},sortChange:function(t){this.listQuery.page=1,this.listQuery.sort="ascending"===t.order?"ASC":"DESC",this.listQuery.order=t.prop,this.loadData()},loadData:function(){var t=this;this.listLoading=!0,this.loadListBefore(this.QueryParams),this.api.Query(this.listQuery).then(function(e){t.afterLoadData&&(e.data.items=t.afterLoadData(e.data.items)),t.list=e.data.items,t.total=e.data.total,t.listLoading=!1,t.$previewRefresh()})},loadListBefore:function(t){return t},SearchData:function(){this.listQuery.page=1,this.loadData()},ExportData:function(){var t=this;this.downloadLoading=!0,Promise.all([a.e("chunk-6e83591c"),a.e("chunk-5164a781"),a.e("chunk-5bdd67a2"),a.e("chunk-54b312fe")]).then(a.bind(null,"4bf8d")).then(function(e){var a=t.list.map(function(e){return t.ExportFormateRow?t.ExportFormateRow(e):e}),i=a.map(function(e){return t.ExportFields.map(function(t){return e[t]})});e.export_json_to_excel({header:t.ExportFields,data:i,filename:"table-list"}),t.downloadLoading=!1})},resetTemp:function(){this.temp={id:void 0}}}}}}]);