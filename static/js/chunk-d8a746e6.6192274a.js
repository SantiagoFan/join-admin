(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-d8a746e6"],{"09f4":function(t,e,i){"use strict";i.d(e,"a",function(){return o}),Math.easeInOutQuad=function(t,e,i,a){return t/=a/2,t<1?i/2*t*t+e:(t--,-i/2*(t*(t-2)-1)+e)};var a=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(t){window.setTimeout(t,1e3/60)}}();function n(t){document.documentElement.scrollTop=t,document.body.parentNode.scrollTop=t,document.body.scrollTop=t}function s(){return document.documentElement.scrollTop||document.body.parentNode.scrollTop||document.body.scrollTop}function o(t,e,i){var o=s(),r=t-o,l=20,c=0;e="undefined"===typeof e?500:e;var u=function t(){c+=l;var s=Math.easeInOutQuad(c,o,r,e);n(s),c<e?a(t):i&&"function"===typeof i&&i()};u()}},"199b":function(t,e,i){},"57dc":function(t,e,i){},"59c8":function(t,e,i){"use strict";var a=i("199b"),n=i.n(a);n.a},"8b31":function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"app-container"},[i("el-tabs",{model:{value:t.type,callback:function(e){t.type=e},expression:"type"}},[i("el-tab-pane",{attrs:{name:"image"}},[i("span",{attrs:{slot:"label"},slot:"label"},[i("i",{staticClass:"el-icon-picture-outline"}),t._v(" 图片 ")]),t._v(" "),i("keep-alive",[i("attachmentImage")],1)],1),t._v(" "),i("el-tab-pane",{attrs:{name:"audio"}},[i("span",{attrs:{slot:"label"},slot:"label"},[i("i",{staticClass:"el-icon-microphone"}),t._v(" 音频 ")])]),t._v(" "),i("el-tab-pane",{attrs:{name:"video"}},[i("span",{attrs:{slot:"label"},slot:"label"},[i("i",{staticClass:"el-icon-video-play"}),t._v(" 视频 ")])]),t._v(" "),i("el-tab-pane",{attrs:{name:"file"}},[i("span",{attrs:{slot:"label"},slot:"label"},[i("i",{staticClass:"el-icon-document"}),t._v(" 文件 ")])])],1)],1)},n=[],s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"attachment-container"},[i("div",{staticClass:"action-container"},[i("el-button",{staticClass:"action-item",attrs:{size:"mini",type:"primary",icon:"el-icon-edit"},on:{click:t.show_upload}},[t._v("上传图片")])],1),t._v(" "),i("el-row",[i("el-col",{attrs:{span:4}},[i("AttachmentGroup",{attrs:{type:"image",editable:!0},on:{change:t.groupChange}})],1),t._v(" "),i("el-col",{attrs:{span:20}},[i("div",{staticClass:"list-container"},[t._l(t.list,function(e){return i("div",{key:e.id,staticClass:"list-item"},[i("el-image",{staticStyle:{width:"170px",height:"170px"},attrs:{src:e.savePath+"!size=ss",large:e.savePath,fit:"cover",preview:"0"}}),t._v(" "),i("div",{staticClass:"actions"},[i("el-checkbox",{model:{value:e.isChecked,callback:function(i){t.$set(e,"isChecked",i)},expression:"o.isChecked"}},[t._v(t._s(e.originalName))]),t._v(" "),i("div",{staticStyle:{"padding-top":"7px"}},[i("el-link",{attrs:{type:"primary"},on:{click:function(i){return t.show_rename(e)}}},[t._v("修改")]),t._v(" |\n              "),i("el-link",{attrs:{type:"primary"},on:{click:function(i){return t.show_delete(e)}}},[t._v("删除")]),t._v(" |\n              "),i("el-popover",{attrs:{placement:"bottom",width:"286",trigger:"click"}},[i("el-input",{staticStyle:{width:"200px"},attrs:{disabled:"",size:"small"},model:{value:e.savePath,callback:function(i){t.$set(e,"savePath",i)},expression:"o.savePath"}}),t._v(" "),i("el-button",{directives:[{name:"clipboard",rawName:"v-clipboard:copy",value:e.savePath,expression:"o.savePath",arg:"copy"},{name:"clipboard",rawName:"v-clipboard:success",value:t.clipboardSuccess,expression:"clipboardSuccess",arg:"success"}],attrs:{size:"small",type:"primary"}},[t._v("复制")]),t._v(" "),i("el-link",{attrs:{slot:"reference",type:"primary"},slot:"reference"},[t._v("链接")])],1)],1)],1)],1)}),t._v(" "),i("div",{staticClass:"list-actions"},[i("el-button",{attrs:{icon:"el-icon-edit"},on:{click:function(e){return t.show_regroup()}}},[t._v("批量修改分组")]),t._v(" "),i("el-button",{attrs:{icon:"el-icon-delete"},on:{click:function(e){return t.show_delete(null)}}},[t._v("批量删除")])],1)],2),t._v(" "),i("pagination",{directives:[{name:"show",rawName:"v-show",value:t.total>0,expression:"total>0"}],attrs:{total:t.total,page:t.listQuery.page,limit:t.listQuery.limit},on:{"update:page":function(e){return t.$set(t.listQuery,"page",e)},"update:limit":function(e){return t.$set(t.listQuery,"limit",e)},pagination:t.loadData}})],1)],1),t._v(" "),i("el-dialog",{attrs:{title:"修改",visible:t.rename_show,width:"30%"},on:{"update:visible":function(e){t.rename_show=e}}},[i("div",[i("el-input",{attrs:{type:"text"},model:{value:t.rename_title,callback:function(e){t.rename_title=e},expression:"rename_title"}}),t._v(" "),i("el-select",{staticStyle:{width:"100%","margin-top":"10px"},attrs:{placeholder:"请选择分组"},model:{value:t.regroup_id,callback:function(e){t.regroup_id=e},expression:"regroup_id"}},t._l(t.groupList,function(t){return i("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}),1)],1),t._v(" "),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(e){t.rename_show=!1}}},[t._v("取 消")]),t._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.handleUpdate("rename")}}},[t._v("确 定")])],1)]),t._v(" "),i("el-dialog",{attrs:{title:"设置分组",visible:t.regroup_show,width:"30%"},on:{"update:visible":function(e){t.regroup_show=e}}},[i("div",[i("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择分组"},model:{value:t.regroup_id,callback:function(e){t.regroup_id=e},expression:"regroup_id"}},t._l(t.groupList,function(t){return i("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}),1)],1),t._v(" "),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(e){t.regroup_show=!1}}},[t._v("取 消")]),t._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.handleUpdate("regroup")}}},[t._v("确 定")])],1)]),t._v(" "),i("el-dialog",{attrs:{title:"本地上传",visible:t.upload_show,width:"800px"},on:{"update:visible":function(e){t.upload_show=e},close:t.hidden_upload}},[i("div",[i("AttachmentUpload",{ref:"Uploader",on:{change:t.fileChane}})],1),t._v(" "),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{type:"primary"},on:{click:t.hidden_upload}},[t._v("确 定")])],1)])],1)},o=[],r=(i("ac6a"),i("a796")),l=i("cebb"),c=i("8325"),u=i("333d"),d=i("a54c"),p=i("b224"),h={name:"AttachmentImage",components:{Pagination:u["a"],AttachmentGroup:d["a"],AttachmentUpload:p["a"]},directives:{clipboard:c["a"]},mixins:[l["a"]],data:function(){return{rename_title:"",regroup_id:null,edit_mode:"single",current_edit_ids:[],rename_show:!1,regroup_show:!1,upload_show:!1,api:r["a"],groupList:[],listQuery:{groupId:null,type:"image"}}},created:function(){},methods:{fileChane:function(){null==this.listQuery.groupId&&this.loadData()},groupChange:function(t,e){this.groupList=e,this.listQuery.groupId=t.id,this.loadData()},show_upload:function(){this.upload_show=!0},hidden_upload:function(){var t=this;this.upload_show=!1,this.$nextTick(function(e){t.$refs.Uploader.clearFiles()})},show_rename:function(t){this.rename_show=!0,this.rename_title=t.originalName,this.regroup_id=t.groupId,this.current_edit_ids=[t.id]},show_regroup:function(){this.rename_title=null,this.regroup_id=null,this.current_edit_ids=this.getSelectIds(),this.current_edit_ids.length>0?this.regroup_show=!0:this.$message({message:"请选择要进行重分组的数据",type:"warning"})},show_delete:function(t){t?(this.current_edit_ids=[t.id],this.handleDelete()):(this.current_edit_ids=this.getSelectIds(),this.current_edit_ids.length>0?this.handleDelete():this.$message({message:"请选择要进行删除的数据",type:"warning"}))},handleUpdate:function(t){var e=this;r["a"].Update({ids:this.current_edit_ids,originalName:this.rename_title,groupId:this.regroup_id}).then(function(t){e.rename_show=!1,e.regroup_show=!1,e.loadData(),e.$message({type:"success",message:"修改成功!"})})},handleDelete:function(){var t=this;this.$confirm("此操作将永久删除该文件, 是否继续?","提示").then(function(){r["a"].Delete({ids:t.current_edit_ids}).then(function(e){t.loadData(),t.$message({type:"success",message:"删除成功!"})})})},getSelectIds:function(){var t=[];return this.list.forEach(function(e){e.isChecked&&t.push(e.id)}),t},getSelectItems:function(){var t=[];return this.list.forEach(function(e){e.isChecked&&t.push(e)}),t},clipboardSuccess:function(){this.$message({message:"复制成功",type:"success",duration:1500})}}},m=h,_=(i("59c8"),i("2877")),f=Object(_["a"])(m,s,o,!1,null,null,null),v=f.exports,g={name:"List",components:{attachmentImage:v},data:function(){return{type:"image"}},created:function(){}},b=g,y=Object(_["a"])(b,a,n,!1,null,null,null);e["default"]=y.exports},a54c:function(t,e,i){"use strict";var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"category-container"},[t.editable?i("div",[i("div",{staticClass:"group_title"},[t._v(t._s(t.current_group.name))]),t._v(" "),i("el-button-group",{directives:[{name:"show",rawName:"v-show",value:null!=t.current_group.id,expression:"current_group.id != null"}]},[i("el-button",{directives:[{name:"popover",rawName:"v-popover:edit_popover",arg:"edit_popover"}],attrs:{size:"mini",icon:"el-icon-edit"}}),t._v(" "),i("el-button",{directives:[{name:"popover",rawName:"v-popover:delete_popover",arg:"delete_popover"}],attrs:{size:"mini",icon:"el-icon-delete"}})],1)],1):t._e(),t._v(" "),t._l(t.list,function(e,a){return i("div",{key:e.id,staticClass:"category-item",class:e.id===t.current_group.id?"active":"",on:{click:function(e){return t.Change(a)}}},[i("span",{staticClass:"category-name"},[t._v(" "+t._s(e.name))]),t._v(" "),i("span",{staticClass:"category-num"},[t._v("100")])])}),t._v(" "),t.editable?i("div",[i("el-popover",{attrs:{placement:"bottom",width:"200",trigger:"click"},model:{value:t.add_show,callback:function(e){t.add_show=e},expression:"add_show"}},[i("el-input",{attrs:{type:"text",size:"small",placeholder:"请输入分类名称",maxlength:"6","show-word-limit":""},model:{value:t.add_title,callback:function(e){t.add_title=e},expression:"add_title"}}),t._v(" "),i("div",{staticStyle:{"text-align":"right","margin-top":"10px"}},[i("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(e){t.add_show=!1}}},[t._v("取消")]),t._v(" "),i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:t.handleCreate}},[t._v("确定")])],1),t._v(" "),i("el-button",{staticStyle:{"margin-top":"10px"},attrs:{slot:"reference",size:"small"},slot:"reference"},[t._v(" + 添加分组")])],1),t._v(" "),i("el-popover",{ref:"edit_popover",attrs:{placement:"bottom",width:"200",trigger:"click"},model:{value:t.edit_show,callback:function(e){t.edit_show=e},expression:"edit_show"}},[i("el-input",{attrs:{type:"text",size:"small",placeholder:"请输入分类名称",maxlength:"6","show-word-limit":""},model:{value:t.edit_title,callback:function(e){t.edit_title=e},expression:"edit_title"}}),t._v(" "),i("div",{staticStyle:{"text-align":"right","margin-top":"10px"}},[i("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(e){t.edit_show=!1}}},[t._v("取消")]),t._v(" "),i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:t.handleEdit}},[t._v("确定")])],1)],1),t._v(" "),i("el-popover",{ref:"delete_popover",attrs:{placement:"top",width:"160"},model:{value:t.delete_show,callback:function(e){t.delete_show=e},expression:"delete_show"}},[i("p",[t._v("仅删除分组，不删除图片，组内图片将自动归入未分组")]),t._v(" "),i("div",{staticStyle:{"text-align":"right"}},[i("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(e){t.delete_show=!1}}},[t._v("取消")]),t._v(" "),i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:t.handleDelete}},[t._v("确定")])],1)])],1):t._e()],2)},n=[],s=(i("7f7f"),i("b775")),o="/backEnd/attachmentGroup",r={Query:function(t){return Object(s["a"])({url:"/backEnd/attachmentGroupQuery",method:"post",data:t})},Delete:function(t){return Object(s["a"])({url:o,method:"delete",data:t})},Update:function(t){return Object(s["a"])({url:o,method:"put",data:t})},Create:function(t){return Object(s["a"])({url:o,method:"post",data:t})}},l=r,c={name:"AttachmentGroup",props:{type:{type:String,default:"image"},editable:{type:Boolean,default:!1}},data:function(){return{api:l,add_show:!1,edit_show:!1,delete_show:!1,current_group:{id:null,name:"未分组"},current_index:0,add_title:"",edit_title:"",list:[]}},mounted:function(){this.loadData()},methods:{handleCreate:function(){var t=this;this.api.Create({name:this.add_title,type:this.type}).then(function(e){2e4===e.code&&(t.loadData(),t.add_show=!1)})},handleEdit:function(){var t=this;this.api.Update({id:this.current_group.id,name:this.edit_title}).then(function(e){2e4===e.code&&(t.current_group.name=t.edit_title,t.edit_show=!1)})},handleDelete:function(){var t=this;this.api.Delete({id:this.current_group.id}).then(function(e){2e4===e.code&&(t.list.splice(t.current_index,1),t.reset(),t.delete_show=!1)})},loadData:function(){var t=this;this.api.Query({type:this.type}).then(function(e){t.list=e.data,t.reset()})},Change:function(t){this.current_group=this.list[t],this.edit_title=this.current_group.name,this.current_index=t,this.$emit("change",this.list[t],this.list)},reset:function(){this.Change(0)}}},u=c,d=(i("a968"),i("2877")),p=Object(d["a"])(u,a,n,!1,null,null,null);e["a"]=p.exports},a796:function(t,e,i){"use strict";var a=i("b775"),n="/backEnd/attachment",s={Query:function(t){return Object(a["a"])({url:"/backEnd/attachmentQuery",method:"post",data:t})},Delete:function(t){return Object(a["a"])({url:n,method:"delete",data:t})},Update:function(t){return Object(a["a"])({url:n,method:"put",data:t})},Create:function(t){return Object(a["a"])({url:n,method:"post",data:t})}};e["a"]=s},a968:function(t,e,i){"use strict";var a=i("57dc"),n=i.n(a);n.a},b224:function(t,e,i){"use strict";var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("el-upload",{ref:"elupload",staticClass:"jui-upload",attrs:{action:t.upload_url,limit:10,multiple:"","auto-upload":!0,"list-type":"picture-card","show-file-list":!0,headers:t.requestHeaders,"on-success":t.uploadSuccess,"on-error":t.uploadError}},[i("i",{staticClass:"el-icon-plus"}),t._v(" "),i("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[t._v("只能上传jpg/png文件，且不超过500kb,建议尺寸：800*800像素,最多上传10张")])])],1)},n=[],s=i("5f87"),o={data:function(){return{upload_url:"/prod-apiuploadByType",requestHeaders:{"X-Token":Object(s["a"])()}}},methods:{clearFiles:function(){var t=this;this.$nextTick(function(e){t.$refs["elupload"].clearFiles()})},uploadSuccess:function(){this.$emit("change")},uploadError:function(){this.$message.error("上传错误")}}},r=o,l=i("2877"),c=Object(l["a"])(r,a,n,!1,null,null,null);e["a"]=c.exports},cebb:function(t,e,i){"use strict";i("ac4d"),i("8a81"),i("ac6a");var a={filters:{statusFilter:function(t){var e={published:"success",draft:"info",deleted:"danger"};return e[t]}}};e["a"]={mixins:[a],data:function(){return{list:[],total:0,Field:"id",listQuery:{page:1,limit:10,order:"id",sort:"DESC"},listLoading:!0,downloadLoading:!1,ExportFields:["id"],dialogFormVisible:!1,dialogStatus:""}},methods:{HandleCreate:function(t){var e=this;if(this.$refs.singleTable.selection.length>0){var i={};i["ids"]=this.$refs.singleTable.selection.map(function(t){return t[e.Field]}),i["type"]=t,this.api.goodsSaleable(i).then(function(t){2e4===t.code?(e.$message({message:"操作成功",type:"success"}),e.SearchData()):e.$message({message:"操作失败",type:"error"})})}else this.$message({message:"请选择要操作的数据",type:"error"})},CreateData:function(){var t=this;this.$refs["dataForm"].validate(function(e){e&&t.api.Create(t.temp).then(function(e){t.dialogFormVisible=!1,t.SearchData(),t.$notify({title:"成功",message:"创建成功",type:"success",duration:2e3})})})},BatchDelete:function(){var t=this;if(this.$refs.singleTable.selection.length>0){var e=this.$refs.singleTable.selection.map(function(e){return e[t.Field]});this.api.Delete(e).then(function(e){2e4===e.code?(t.$message({message:"操作成功",type:"success"}),t.SearchData()):t.$message({message:"操作失败",type:"error"})})}else this.$message({message:"请选择删除的数据",type:"error"})},RowDelete:function(t){var e=this,i=[t[this.Field]];this.api.Delete(i).then(function(t){2e4===t.code?(e.$message({message:"操作成功",type:"success"}),e.SearchData()):e.$message({message:"操作失败",type:"error"})})},HandleUpdate:function(t){this.temp=Object.assign({},t),this.dialogStatus="update",this.dialogFormVisible=!0},UpdateData:function(){var t=this;this.$refs["dataForm"].validate(function(e){if(e){var i=Object.assign({},t.temp);t.api.Update(i).then(function(e){var i=!0,a=!1,n=void 0;try{for(var s,o=t.list[Symbol.iterator]();!(i=(s=o.next()).done);i=!0){var r=s.value;if(r.id===t.temp.id){var l=t.list.indexOf(r);t.list.splice(l,1,t.temp);break}}}catch(c){a=!0,n=c}finally{try{i||null==o.return||o.return()}finally{if(a)throw n}}t.dialogFormVisible=!1,t.$notify({title:"成功",message:"更新成功",type:"success",duration:2e3})})}})},ConfirmData:function(){"create"===this.dialogStatus?this.CreateData():this.UpdateData()},sortChange:function(t){this.listQuery.page=1,this.listQuery.sort="ascending"===t.order?"ASC":"DESC",this.listQuery.order=t.prop,this.loadData()},loadData:function(){var t=this;this.listLoading=!0,this.loadListBefore(this.QueryParams),this.api.Query(this.listQuery).then(function(e){t.afterLoadData&&(e.data.items=t.afterLoadData(e.data.items)),t.list=e.data.items,t.total=e.data.total,t.listLoading=!1,t.$previewRefresh()})},loadListBefore:function(t){return t},SearchData:function(){this.listQuery.page=1,this.loadData()},ExportData:function(){var t=this;this.downloadLoading=!0,Promise.all([i.e("chunk-6e83591c"),i.e("chunk-5164a781"),i.e("chunk-5bdd67a2"),i.e("chunk-54b312fe")]).then(i.bind(null,"4bf8d")).then(function(e){var i=t.list.map(function(e){return t.ExportFormateRow?t.ExportFormateRow(e):e}),a=i.map(function(e){return t.ExportFields.map(function(t){return e[t]})});e.export_json_to_excel({header:t.ExportFields,data:a,filename:"table-list"}),t.downloadLoading=!1})},resetTemp:function(){this.temp={id:void 0}}}}}}]);